ğŸ“˜ k6 Performance Testing POC â€“ Customer Services APIs
ğŸ§  What is k6?
k6 is an open-source, developer-centric tool for performance testing and load testing of APIs, written in JavaScript.
It is designed for automation, CI/CD integration, and simulating realistic user traffic at scale.

ğŸ¯ POC Objective
Evaluate k6 for API performance/load testing

Handle JWT-based authentication dynamically

Test multiple microservice endpoints with real customer data

Run tests locally and in GitLab CI pipelines

Establish a modular, reusable testing framework

ğŸ“ Project Structure
kotlin
Copy
Edit
k6-tests/
â”œâ”€â”€ main.js               â†’ Orchestrator: token setup + test flow
â”œâ”€â”€ config.js             â†’ Shared config (BASE_URL, constants)
â”œâ”€â”€ data/
â”‚   â””â”€â”€ customer_ids.txt  â†’ Test data: list of valid customer IDs
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ getPaymentPref.js
â”‚   â”œâ”€â”€ getCustChannelRef.js
â”‚   â””â”€â”€ getPSNPreferences.js
â””â”€â”€ README.md             â†’ Setup instructions and usage guide
ğŸ” JWT Token Handling
Tokens are generated at runtime from JWT utility API:

bash
Copy
Edit
POST /jwtutility/jwt
Payload includes:

alg: RS256

typ: JWT

aud: rbsg.banklinedirectdigital.pre-prd.bdd-ms-customer-process

exp: set to 1 hour from now

Tokens are passed in custom header:

makefile
Copy
Edit
iam-claimsetjwt: <token>
ğŸ” Endpoints Covered
Endpoint	Method	Auth	Description
/getPaymentPref/{custId}	GET	âœ…	Fetches payment preferences
/getCustChannelRefForPhysDest	POST	âœ…	Requires payload with destination
/v1/getPSNPreferences/{custId}	GET	âœ…	Returns PSNP preferences for a customer

ğŸ§ª Test Execution
â–¶ï¸ Local Execution
bash
Copy
Edit
k6 run main.js
âš™ï¸ GitLab CI Job Snippet
yaml
Copy
Edit
script:
  - k6 run --summary-export=result.json main.js
artifacts:
  paths:
    - result.json
âœ… result.json captures test metrics for reporting

ğŸ“Š Sample Output Summary
text
Copy
Edit
âœ“ status is 200 ....................: 100%
âœ“ response includes custId ........: 100%
http_req_duration .................: avg=42ms, p(95)=63ms
http_req_failed ...................: 0.00%
iterations ........................: 50
vus ...............................: 10
ğŸ” Observations
âœ… Dynamic JWT authentication works reliably across modules

âœ… Endpoints respond within acceptable latency (~40â€“60ms)

âœ… Modular JS test files improve maintainability

âŒ Initial test failures due to invalid custIds â€“ resolved using curated dataset

ğŸš€ Next Steps
Add SLA thresholds (e.g., 95% of requests under 100ms)

Integrate with Grafana via InfluxDB or JSON upload

Automate test execution post-deploy via GitLab

Extend test suite to additional services

ğŸ”— Related Links
ğŸ“ GitLab Repo

ğŸ” JWT Utility API Spec

ğŸ“– k6 Docs

